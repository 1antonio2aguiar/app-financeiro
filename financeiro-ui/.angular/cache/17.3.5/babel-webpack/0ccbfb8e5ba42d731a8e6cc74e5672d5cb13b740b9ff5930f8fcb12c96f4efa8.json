{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, Input } from '@angular/core';\nimport { HttpParams } from '@angular/common/http';\nimport { BaseResourceListComponent } from 'src/app/shared/components/base-resource-list/base-resource-list.component';\nimport { environment } from 'src/environments/environment';\nimport { ParcelasContratosCadastroComponent } from '../parcelas-contratos-cadastro/parcelas-contratos-cadastro.component';\nimport { ParcelasContratosFiltro } from '../parcelas-contratos-filtro';\nlet ParcelasContratosPesquisaComponent = class ParcelasContratosPesquisaComponent extends BaseResourceListComponent {\n  // Retorna os dados da lista de parcelas aqui.\n  ngOnInit() {\n    //console.log(\"AI OOOOO ESTA AQUI PARA RECUPERAR LISTA \", this.filtro.pagina)\n    this.loadListParcelasContratos();\n  }\n  constructor(parcelasContratosService, confirmationService, messageService, dialogService) {\n    super(parcelasContratosService, confirmationService, messageService);\n    this.parcelasContratosService = parcelasContratosService;\n    this.confirmationService = confirmationService;\n    this.messageService = messageService;\n    this.dialogService = dialogService;\n    this.filtro = new ParcelasContratosFiltro();\n    this.modalVisible = false;\n    this.env = environment;\n    this.loading = true;\n    this.receitaDespesa = \"\";\n    this.grupoFinanceiro = \"\";\n    this.tipoGrupoFinanceiro = \"\";\n    this.totalRegistros = 0;\n  }\n  // Abre Modal Parcelas Contratos - nova parcela\n  showParcelasContratosModalNew($event) {\n    this.env.currentActionGlobal = \"NEW\";\n    this.modalVisible = true;\n    this.contratoId = document.getElementById('id').value;\n    this.parcelasContratosService.buscaMaxParcelaContrato(this.contratoId);\n    const ref = this.dialogService.open(ParcelasContratosCadastroComponent, {\n      header: 'Informe as parcelas',\n      width: '70%'\n    });\n    ref.onClose.subscribe(r => {\n      this.filtro.pagina = 0;\n      //ATUALIZA A LISTA DE PARCELAS\n      // parte de filtrar as parcelas do contrato\n      this.filtro.params['updates'] = [{\n        op: 'a',\n        param: 'contratoId',\n        value: this.contratoId\n      }];\n      this.parcelasContratosService.listAllYesPaginacao(this.filtro);\n    });\n  }\n  showParcelasContratosModalEdit(parcelaId) {\n    this.env.currentActionGlobal = \"EDIT\";\n    this.modalVisible = true;\n    const ref = this.dialogService.open(ParcelasContratosCadastroComponent, {\n      header: 'Editando parcela ',\n      width: '70%'\n    });\n    this.parcelasContratosService.buscaParcelaContrato(parcelaId);\n    ref.onClose.subscribe(() => {\n      this.filtro.pagina = 0;\n      //ATUALIZA A LISTA DE PARCELAS\n      // parte de filtrar as parcelas do contrato\n      this.contratoId = document.getElementById('id').value;\n      this.filtro.params['updates'] = [{\n        op: 'a',\n        param: 'contratoId',\n        value: this.contratoId\n      }];\n      this.parcelasContratosService.listAllYesPaginacao(this.filtro);\n    });\n  }\n  showParcelasContratosModalDelete(parcelaId) {\n    this.env.currentActionGlobal = \"DELETE\";\n    this.modalVisible = true;\n    this.env.botaoOnOf = false;\n    const ref = this.dialogService.open(ParcelasContratosCadastroComponent, {\n      header: 'CONFIRMA DELETAR PARCELA? ',\n      width: '65%',\n      //styleClass:\n      contentStyle: {\n        \"background-color\": \"red\",\n        \"font-size\": \"3px\"\n      }\n      //      style: {\"background-color\": \"blue\"},\n    });\n    this.parcelasContratosService.buscaParcelaContrato(parcelaId);\n    ref.onClose.subscribe(() => {\n      this.filtro.pagina = 0;\n      //ATUALIZA A LISTA DE PARCELAS\n      // parte de filtrar as parcelas do contrato\n      this.contratoId = document.getElementById('id').value;\n      this.filtro.params['updates'] = [{\n        op: 'a',\n        param: 'contratoId',\n        value: this.contratoId\n      }];\n      this.parcelasContratosService.listAllYesPaginacao(this.filtro);\n    });\n  }\n  pesquisar(pagina = 0) {\n    this.filtro.pagina = pagina;\n    if (this.totalRegistros == 0) {\n      this.filtro.totalRegistros = 10;\n    } else {\n      this.filtro.totalRegistros = this.totalRegistros;\n    }\n    // parte de filtrar as parcelas do contrato\n    this.contratoId = document.getElementById('id').value;\n    //this.filtro.params = this.filtro.params.append('contratoId', this.contratoId);\n    this.parcelasContratosService.pesquisar(this.filtro).then(resultado => {\n      this.loading = false;\n      this.resources = resultado;\n    }).catch(erro => {\n      console.log(\"Deu erro \");\n      erro = 'Erro';\n      this.loading = false;\n    });\n  }\n  aoMudarPagina(event) {\n    const pagina = event.first / event.rows;\n    this.filtro.params = new HttpParams();\n    this.contratoId = document.getElementById('id').value;\n    if (this.contratoId == '') {\n      this.contratoId = '0';\n    }\n    this.filtro.params = this.filtro.params.append('contratoId', this.contratoId);\n    this.pesquisar(pagina);\n  }\n  // Retorna lista de parcelas e rederiza HTML da lista\n  loadListParcelasContratos() {\n    if (this.totalRegistros == 0) {\n      this.filtro.totalRegistros = 10;\n    } else {\n      this.filtro.totalRegistros = this.totalRegistros;\n    }\n    this.parcelasContratosService.parcelasContratosChangeSubscribe(resources => {\n      this.totalRegistros = resources['totalElements'];\n      this.resources = resources;\n      this.receitaDespesa = document.getElementById('receitaDespesa').value;\n      this.grupoFinanceiro = document.getElementById('grupoFinanceiro').value;\n      this.tipoGrupoFinanceiro = document.getElementById('tipoGrupoFinanceiro').value;\n    });\n  }\n};\n__decorate([Input()], ParcelasContratosPesquisaComponent.prototype, \"contratoId\", void 0);\nParcelasContratosPesquisaComponent = __decorate([Component({\n  selector: 'app-parcelas-contratos-pesquisa',\n  templateUrl: './parcelas-contratos-pesquisa.component.html',\n  styleUrls: ['./parcelas-contratos-pesquisa.component.css']\n})], ParcelasContratosPesquisaComponent);\nexport { ParcelasContratosPesquisaComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}