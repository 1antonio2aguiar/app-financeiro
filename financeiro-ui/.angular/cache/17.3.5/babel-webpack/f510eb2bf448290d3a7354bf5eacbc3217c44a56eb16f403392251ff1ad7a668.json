{"ast":null,"code":"import { MessageService } from 'primeng/api';\nimport { BaseResourceFormComponent } from '../../../../shared/components/base-resource-form/base-resource-form.component';\nimport { Validators } from '@angular/forms';\nimport { DialogService } from 'primeng/dynamicdialog';\nimport { environment } from 'src/environments/environment';\nimport { Enderecos } from './../../../../shared/models/enderecos';\nimport { CidadesModalComponent } from '../../../cidades/cidades-modal/cidades-modal.component';\nimport { BairrosModalComponent } from './../../../bairros/bairros-modal/bairros-modal.component';\nimport { LogradourosModalComponent } from './../../../logradouros/logradouros-modal/logradouros-modal.component';\nimport { CepsModalComponent } from '../../../ceps/ceps-modal/ceps-modal.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../enderecos.service\";\nimport * as i2 from \"primeng/api\";\nimport * as i3 from \"primeng/dynamicdialog\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"../../../../shared/components/form-field-error/form-field-error.component\";\nimport * as i7 from \"angular-imask\";\nimport * as i8 from \"primeng/button\";\nimport * as i9 from \"primeng/inputtext\";\nimport * as i10 from \"primeng/panel\";\nimport * as i11 from \"primeng/dropdown\";\nfunction EnderecosModalComponent_div_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵelement(1, \"button\", 39);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", ctx_r0.submittingForm || ctx_r0.resourceForm.invalid);\n  }\n}\nfunction EnderecosModalComponent_div_55_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵelement(1, \"button\", 40);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", ctx_r0.submittingForm || ctx_r0.resourceForm.invalid);\n  }\n}\nexport let EnderecosModalComponent = /*#__PURE__*/(() => {\n  class EnderecosModalComponent extends BaseResourceFormComponent {\n    constructor(enderecosService, injector, messageService, dialogService, ref) {\n      super(injector, new Enderecos(), enderecosService, Enderecos.fromJson, new MessageService());\n      this.enderecosService = enderecosService;\n      this.injector = injector;\n      this.messageService = messageService;\n      this.dialogService = dialogService;\n      this.ref = ref;\n      this.tiposEnderecosList = [{\n        value: 'R',\n        selected: false,\n        label: 'RESIDENCIAL'\n      }, {\n        value: 'C',\n        selected: false,\n        label: 'COMERCIAL'\n      }];\n      this.env = environment;\n      this.enderecoId = 0;\n      this.masks = {\n        mask: [{\n          mask: '00.000-000'\n        }]\n      };\n      //Move os dados da pessoas para o modal de cadastro de enderecos\n      this.dadosPessoa = document.getElementById('nome').value + ' CPF: ' + document.getElementById('cpfCnpj').value;\n      //this.loadTipoLogradouro();\n      this.buildResourceForm(); /*limpa o formulario/resourceForm */\n      if (this.env.currentActionGlobal != \"DELETE\") {\n        this.env.botaoOnOf = false;\n        this.env.botaoOnOfCep = false;\n      } else {\n        this.env.botaoOnOf = true;\n        this.env.botaoOnOfCep = true;\n      }\n    }\n    buildResourceForm() {\n      this.resourceForm = this.formBuilder.group({\n        id: [null],\n        pessoa: [document.getElementById('id').value],\n        tipoEndereco: [null, [Validators.required]],\n        cidades: this.formBuilder.group({\n          estados: this.formBuilder.group({\n            uf: [null]\n          }),\n          id: [null],\n          nome: [null]\n        }),\n        bairros: this.formBuilder.group({\n          id: [null, [Validators.required, Validators.maxLength(10)]],\n          nome: [null]\n        }),\n        bairro: [null],\n        logradouros: this.formBuilder.group({\n          id: [null, [Validators.required, Validators.maxLength(15)]],\n          nome: [null],\n          tiposLogradouros: this.formBuilder.group({\n            sigla: [null]\n          })\n        }),\n        logradouro: [null],\n        ceps: this.formBuilder.group({\n          cep: [null]\n        }),\n        cep: [null],\n        numero: [null, [Validators.required, Validators.minLength(1)]],\n        complemento: [null]\n      });\n    }\n    submitForm() {\n      //this.submittingForm = true;\n      if (this.env.currentActionGlobal === 'NEW') {\n        // clicou no + (novo)\n        this.createResource();\n      } else {\n        if (this.env.currentActionGlobal === 'EDIT') {\n          // clicou no update\n          this.updateResource();\n        } else {\n          // clicou no delete\n          this.deleteResource();\n        }\n      }\n    }\n    deleteResource() {\n      this.enderecosService.deleteEndereco(this.enderecoId).then(response => {\n        this.buildResourceForm(); /*limpa o formulario/resorceForm*/\n        this.ref.close();\n      });\n    }\n    updateResource() {\n      const resource = this.jsonDataToResourceFn(this.resourceForm.value);\n      // copia os dados de Enderecos(classe) para enderecos(variavel json)\n      let enderecos = JSON.stringify(resource);\n      // Chama a funcao que faz update\n      this.enderecosService.updateEndereco(enderecos).then(response => {\n        this.buildResourceForm(); /*limpa o formulario/resorceForm*/\n        this.ref.close();\n      });\n    }\n    createResource() {\n      const resource = this.jsonDataToResourceFn(this.resourceForm.value);\n      // copia os dados de Enderecos(classe) para enderecos(variavel json)\n      let enderecos = JSON.stringify(resource);\n      // Chama a funcao que insere\n      this.enderecosService.createEndereco(enderecos).then(response => {\n        this.buildResourceForm(); /*limpa o formulario/resorceForm*/\n        this.ref.close();\n      }).catch(error => {\n        console.log(error);\n        this.messageService.add({\n          severity: 'error',\n          summary: 'Erro',\n          detail: error.error[0].mensagemUsuario\n        });\n      });\n    }\n    fecharModal() {\n      this.ref.close();\n    }\n    //Modal CEP\n    showCeps($event) {\n      const ref = this.dialogService.open(CepsModalComponent, {\n        header: 'Selecione o CEP',\n        width: '70%'\n      });\n      ref.onClose.subscribe(cep => {\n        this.env.botaoOnOf = true;\n        //console.log(cep);\n        this.resourceForm.patchValue({\n          ceps: {\n            id: cep.id,\n            cep: cep.cep\n          },\n          cep: cep.id\n        });\n        this.resourceForm.patchValue({\n          cidades: {\n            id: cep.bairros.cidades.id,\n            nome: cep.bairros.cidades.nome,\n            estados: {\n              uf: cep.bairros.cidades.estados.uf\n            }\n          }\n        });\n        this.resourceForm.patchValue({\n          bairros: {\n            id: cep.bairros.id,\n            nome: cep.bairros.nome\n          },\n          bairro: cep.bairros.id\n        });\n        this.resourceForm.patchValue({\n          logradouros: {\n            id: cep.logradouros.id,\n            nome: cep.logradouros.nome,\n            tiposLogradouros: {\n              sigla: cep.logradouros.tiposLogradouros.sigla\n            }\n          },\n          logradouro: cep.logradouros.id\n        });\n      });\n    }\n    // Modal Cidade/distrito/estado\n    showCidades($event) {\n      const ref = this.dialogService.open(CidadesModalComponent, {\n        header: 'Selecione a Cidade',\n        width: '70%'\n      });\n      ref.onClose.subscribe(cidade => {\n        this.resourceForm.patchValue({\n          cidades: {\n            id: cidade.id,\n            nome: cidade.nome,\n            estados: {\n              uf: cidade.estados.uf\n            }\n          }\n        });\n      });\n    }\n    // Modal Bairro\n    showBairros($event) {\n      const ref = this.dialogService.open(BairrosModalComponent, {\n        header: 'Selecione o Bairro',\n        width: '70%',\n        data: {\n          // parte de filtrar bairros da cidade\n          idCidade: this.resourceForm.get('cidades').get('id').value\n        }\n      });\n      ref.onClose.subscribe(bairro => {\n        this.resourceForm.patchValue({\n          bairros: {\n            id: bairro.id,\n            nome: bairro.nome\n          }\n        });\n      });\n    }\n    // Modal Logradouro\n    showLogradouros($event) {\n      const ref = this.dialogService.open(LogradourosModalComponent, {\n        header: 'Selecione o Logradouro',\n        width: '70%',\n        data: {\n          // parte de filtrar logradouros da cidade\n          idCidade: this.resourceForm.get('cidades').get('id').value\n        }\n      });\n      ref.onClose.subscribe(logradouro => {\n        this.resourceForm.patchValue({\n          logradouros: {\n            id: logradouro.id,\n            nome: logradouro.nome,\n            tiposLogradouros: {\n              sigla: logradouro.tiposLogradouros.sigla\n            }\n          }\n        });\n      });\n    }\n    // No edit retorna os dados aqui.\n    ngOnInit() {\n      this.enderecosService.enderecosEditSubscribeId(resources => {\n        this.enderecoId = resources.id;\n        this.resourceForm.patchValue({\n          tipoEndereco: resources.tipoEndereco,\n          cidades: {\n            estados: {\n              uf: resources.bairros.cidades.estados.uf\n            },\n            nome: resources.bairros.cidades.nome\n          },\n          bairros: {\n            id: resources.bairros.id,\n            nome: resources.bairros.nome\n          },\n          bairro: resources.bairros.id,\n          logradouros: {\n            id: resources.logradouros.id,\n            nome: resources.logradouros.nome,\n            tiposLogradouros: {\n              sigla: resources.logradouros.tiposLogradouros.sigla\n            }\n          },\n          logradouro: resources.logradouros.id,\n          ceps: {\n            id: resources.ceps.id,\n            cep: resources.ceps.cep\n          },\n          cep: resources.ceps.id,\n          id: resources.id,\n          numero: resources.numero,\n          complemento: resources.complemento\n        });\n      });\n      if (this.env.currentActionGlobal === \"DELETE\") {\n        document.getElementById('numero').disabled = true;\n        document.getElementById('complemento').disabled = true;\n        document.getElementById('btnCep').style.display = \"none\";\n        document.getElementById('btnCidade').style.display = \"none\";\n        document.getElementById('btnBairro').style.display = \"none\";\n        document.getElementById('btnLogradouro').style.display = \"none\";\n      } else {\n        document.getElementById('numero').disabled = false;\n        document.getElementById('complemento').disabled = false;\n        if (this.env.currentActionGlobal === \"EDIT\") {\n          this.env.botaoOnOf = true;\n          this.env.botaoOnOfCep = true;\n        }\n        //(<HTMLSelectElement>document.getElementById('btnCep')).style.display = \"block\";\n      }\n    }\n    static #_ = this.ɵfac = function EnderecosModalComponent_Factory(t) {\n      return new (t || EnderecosModalComponent)(i0.ɵɵdirectiveInject(i1.EnderecosService), i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject(i2.MessageService), i0.ɵɵdirectiveInject(i3.DialogService), i0.ɵɵdirectiveInject(i3.DynamicDialogRef));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: EnderecosModalComponent,\n      selectors: [[\"app-enderecos-modal\"]],\n      features: [i0.ɵɵProvidersFeature([DialogService]), i0.ɵɵInheritDefinitionFeature],\n      decls: 56,\n      vars: 15,\n      consts: [[3, \"header\"], [3, \"submit\", \"formGroup\"], [1, \"p-grid\", \"ui-fluid\", 2, \"margin-top\", \"5px\"], [1, \"p-col-12\", \"p-md-12\", \"p-lg-12\"], [\"for\", \"tipoEnderecoDdw\"], [\"id\", \"tipoEnderecoDdw\", \"name\", \"tipoEnderecoDdw\", \"placeholder\", \"Selecione\", \"formControlName\", \"tipoEndereco\", 3, \"options\", \"filter\", \"disabled\"], [\"header-colum\", \"Tipo Endere\\u00E7o\", 3, \"form-control\"], [1, \"p-col-12\", \"p-md-6\", \"p-lg-6\"], [\"for\", \"cep\"], [\"formGroupName\", \"ceps\", 1, \"ui-inputgroup\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Buscar\", \"id\", \"btnCep\", 3, \"click\", \"disabled\"], [\"placeholder\", \"Informe o CEP\", \"id\", \"cep\", \"type\", \"text\", \"size\", \"20\", \"pInputText\", \"\", \"formControlName\", \"cep\", \"disabled\", \"true\", 2, \"font-weight\", \"bold\", 3, \"imask\", \"unmask\"], [1, \"p-col-12\", \"p-md-2\", \"p-lg-2\"], [\"for\", \"numero\"], [\"id\", \"numero\", \"type\", \"text\", \"size\", \"10\", \"pInputText\", \"\", \"formControlName\", \"numero\"], [\"header-colum\", \"N\\u00FAmero\", 3, \"form-control\"], [1, \"p-col-12\", \"p-md-4\", \"p-lg-4\"], [\"for\", \"complemento\"], [\"id\", \"complemento\", \"type\", \"text\", \"size\", \"20\", \"pInputText\", \"\", \"formControlName\", \"complemento\"], [\"formGroupName\", \"cidades\", 1, \"p-col-12\", \"p-md-11\", \"p-lg-11\"], [\"for\", \"cidade\"], [1, \"ui-inputgroup\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Buscar\", \"id\", \"btnCidade\", 3, \"click\", \"disabled\"], [\"type\", \"text\", \"pInputText\", \"\", \"placeholder\", \"Informe a cidade\", \"formControlName\", \"nome\", \"disabled\", \"true\", 2, \"font-weight\", \"bold\"], [\"formGroupName\", \"cidades\", 1, \"p-col-12\", \"p-md-1\", \"p-lg-1\"], [\"for\", \"sigla\"], [\"formGroupName\", \"estados\"], [\"id\", \"sigla\", \"type\", \"text\", \"size\", \"2\", \"pInputText\", \"\", \"formControlName\", \"uf\", \"disabled\", \"true\", 2, \"font-weight\", \"bold\"], [\"formGroupName\", \"bairros\", 1, \"p-col-12\", \"p-md-12\", \"p-lg-12\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Buscar\", \"id\", \"btnBairro\", 3, \"click\", \"disabled\"], [\"type\", \"text\", \"pInputText\", \"\", \"placeholder\", \"Informe o bairro\", \"formControlName\", \"nome\", \"disabled\", \"true\", 2, \"font-weight\", \"bold\"], [\"formGroupName\", \"logradouros\", 1, \"p-col-12\", \"p-md-10\", \"p-lg-10\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Buscar\", \"id\", \"btnLogradouro\", 3, \"click\", \"disabled\"], [\"type\", \"text\", \"pInputText\", \"\", \"placeholder\", \"Informe o logradouro\", \"formControlName\", \"nome\", \"disabled\", \"true\", 2, \"font-weight\", \"bold\"], [\"formGroupName\", \"logradouros\", 1, \"p-col-12\", \"p-md-2\", \"p-lg-2\"], [\"formGroupName\", \"tiposLogradouros\"], [\"id\", \"sigla\", \"type\", \"text\", \"size\", \"2\", \"pInputText\", \"\", \"formControlName\", \"sigla\", \"disabled\", \"true\", 2, \"font-weight\", \"bold\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Cancelar\", 1, \"ui-button-danger\", 3, \"click\"], [\"class\", \"p-col-12 p-md-2 p-lg-2\", 4, \"ngIf\"], [\"pButton\", \"\", \"type\", \"button\", \"type\", \"submit\", \"icon\", \"pi pi-check\", \"id\", \"btnSalvar\", \"value\", \"Salvar\", \"label\", \"Salvar\", 1, \"ui-button-success\", 3, \"disabled\"], [\"pButton\", \"\", \"type\", \"button\", \"type\", \"submit\", \"icon\", \"pi pi-check\", \"id\", \"btnSalvar\", \"value\", \"Salvar\", \"label\", \"Sim\", 1, \"ui-button-success\", 3, \"disabled\"]],\n      template: function EnderecosModalComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"p-panel\", 0)(1, \"form\", 1);\n          i0.ɵɵlistener(\"submit\", function EnderecosModalComponent_Template_form_submit_1_listener() {\n            return ctx.submitForm();\n          });\n          i0.ɵɵelementStart(2, \"div\", 2)(3, \"div\", 3)(4, \"label\", 4);\n          i0.ɵɵtext(5, \"Tipo Endere\\u00E7o\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"p-dropdown\", 5);\n          i0.ɵɵelement(7, \"app-form-field-error\", 6);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"div\", 7)(9, \"label\", 8);\n          i0.ɵɵtext(10, \"C.E.P\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(11, \"div\", 9)(12, \"button\", 10);\n          i0.ɵɵlistener(\"click\", function EnderecosModalComponent_Template_button_click_12_listener($event) {\n            return ctx.showCeps($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(13, \"input\", 11);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(14, \"div\", 12)(15, \"label\", 13);\n          i0.ɵɵtext(16, \"N\\u00FAmero\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(17, \"input\", 14)(18, \"app-form-field-error\", 15);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"div\", 16)(20, \"label\", 17);\n          i0.ɵɵtext(21, \"Complemento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(22, \"input\", 18);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"div\", 19)(24, \"label\", 20);\n          i0.ɵɵtext(25, \"Cidade\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(26, \"div\", 21)(27, \"button\", 22);\n          i0.ɵɵlistener(\"click\", function EnderecosModalComponent_Template_button_click_27_listener($event) {\n            return ctx.showCidades($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(28, \"input\", 23);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(29, \"div\", 24)(30, \"label\", 25);\n          i0.ɵɵtext(31, \"Estado\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(32, \"span\", 26);\n          i0.ɵɵelement(33, \"input\", 27);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(34, \"div\", 28)(35, \"label\", 20);\n          i0.ɵɵtext(36, \"Bairro\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(37, \"div\", 21)(38, \"button\", 29);\n          i0.ɵɵlistener(\"click\", function EnderecosModalComponent_Template_button_click_38_listener($event) {\n            return ctx.showBairros($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(39, \"input\", 30);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(40, \"div\", 31)(41, \"label\", 20);\n          i0.ɵɵtext(42, \"Logradouro\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(43, \"div\", 21)(44, \"button\", 32);\n          i0.ɵɵlistener(\"click\", function EnderecosModalComponent_Template_button_click_44_listener($event) {\n            return ctx.showLogradouros($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(45, \"input\", 33);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(46, \"div\", 34)(47, \"label\", 25);\n          i0.ɵɵtext(48, \"Tipo\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(49, \"span\", 35);\n          i0.ɵɵelement(50, \"input\", 36);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(51, \"div\", 2)(52, \"div\", 12)(53, \"button\", 37);\n          i0.ɵɵlistener(\"click\", function EnderecosModalComponent_Template_button_click_53_listener() {\n            return ctx.fecharModal();\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(54, EnderecosModalComponent_div_54_Template, 2, 1, \"div\", 38)(55, EnderecosModalComponent_div_55_Template, 2, 1, \"div\", 38);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"header\", ctx.dadosPessoa);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"formGroup\", ctx.resourceForm);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"options\", ctx.tiposEnderecosList)(\"filter\", false)(\"disabled\", ctx.env.botaoOnOf);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"form-control\", ctx.resourceForm.get(\"tipoEndereco\"));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"disabled\", ctx.env.botaoOnOfCep);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"imask\", ctx.masks)(\"unmask\", true);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"form-control\", ctx.resourceForm.get(\"numero\"));\n          i0.ɵɵadvance(9);\n          i0.ɵɵproperty(\"disabled\", ctx.env.botaoOnOf);\n          i0.ɵɵadvance(11);\n          i0.ɵɵproperty(\"disabled\", ctx.env.botaoOnOf);\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"disabled\", ctx.env.botaoOnOf);\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"ngIf\", ctx.env.currentActionGlobal != \"DELETE\");\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.env.currentActionGlobal === \"DELETE\");\n        }\n      },\n      dependencies: [i4.NgIf, i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.FormGroupDirective, i5.FormControlName, i5.FormGroupName, i6.FormFieldErrorComponent, i7.IMaskDirective, i8.ButtonDirective, i9.InputText, i10.Panel, i11.Dropdown]\n    });\n  }\n  return EnderecosModalComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}